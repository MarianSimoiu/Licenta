'use strict';

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _enzyme = require('enzyme');

var _chart = require('chart.js');

var _chart2 = _interopRequireDefault(_chart);

var _index = require('../index');

var _index2 = _interopRequireDefault(_index);

var _Dataset = require('../../Dataset');

var _Dataset2 = _interopRequireDefault(_Dataset);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

jest.mock('chart.js', function () {
    return jest.fn(function () {
        return { update: jest.fn() };
    });
});

describe('<Chart />', function () {
    it('should call ChartJS to render the chart when the component is mounted', function () {
        (0, _enzyme.mount)(_react2.default.createElement(
            _index2.default,
            { labels: ['A', 'B', 'C', 'D'], type: 'line' },
            _react2.default.createElement(_Dataset2.default, { values: [34, 345, 234, 234], title: 'Dataset 1' })
        ));

        expect(_chart2.default).toHaveBeenCalledWith(expect.any(Object), {
            type: 'line',
            data: {
                labels: ['A', 'B', 'C', 'D'],
                datasets: [expect.any(Object)]
            },
            options: expect.any(Object)
        });
    });
    it('should call ChartJS update method to update the chart when the component changes', function () {
        var component = (0, _enzyme.mount)(_react2.default.createElement(
            _index2.default,
            { labels: ['A', 'B', 'C', 'D'], type: 'line' },
            _react2.default.createElement(_Dataset2.default, { values: [34, 345, 234, 234], title: 'Dataset 1' })
        ));
        var chartInstance = component.instance().chartInstance;
        component.setProps({
            labels: ['A', 'B', 'C', 'D', 'E']
        });

        expect(chartInstance.update).toHaveBeenCalledTimes(1);
    });

    it('should call ChartJS update method to update the chart when the children changes', function () {
        var component = (0, _enzyme.mount)(_react2.default.createElement(
            _index2.default,
            { labels: ['A', 'B', 'C', 'D'], type: 'line' },
            _react2.default.createElement(_Dataset2.default, { values: [34, 345, 234, 234], title: 'Dataset 1' })
        ));
        var chartInstance = component.instance().chartInstance;
        component.setProps({
            children: [_react2.default.createElement(_Dataset2.default, { values: [34, 345, 234, 234, 90], title: 'Dataset 1' })]
        });
        expect(chartInstance.update).toHaveBeenCalledTimes(1);
    });
});